<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>2191298_김종현_OpenChallenge11</title>
</head>
<script>
    function chart() {
        let colors = ["blue", "green", "yellow", "magenta", "red"];
        let grades = ["A", "B", "C", "D", "F"];
        let p_sum = [];
        let canvas = document.getElementById("myCanvas");
        let context = canvas.getContext("2d");
        context.font = "14px serif"
        context.clearRect(0, 0, canvas.width, canvas.height);

        let sum = 0;
        let score = document.getElementsByClassName("score");
        let scores = [];
        for (let i = 0; i < 5; i++) {
            scores[i] = Number(score[i].value); //className을 받아온 값들은 String이기 때문에 Number로 바꾸는 과정 수행
            sum += scores[i];
        }

        for (let i = 0; i < 5; i++) {
            p_sum[i] = Math.round(scores[i] / sum * 100);
        }

        context.fillStyle = "blue";
        for (let j = 0; j < 5; j++) {
            context.fillText(grades[j] + " 학점" + p_sum[j] + "%: " + colors[j], 10, 30 + j * 20);
        }

        let startAngle = 0;
        let endAngle = 0;
        for (let i = 0; i < 5; i++) {
            context.beginPath();
            context.moveTo(canvas.width / 2, canvas.height / 2);
            console.log("start ", colors[i], " ", startAngle);
            endAngle = startAngle + (Math.PI * 2) / 100 * p_sum[i];
            console.log("end ", endAngle);
            context.arc(canvas.width / 2, canvas.height / 2, 200, startAngle, endAngle);
            context.closePath();
            context.fillStyle = colors[i];
            context.fill();
            startAngle = endAngle;
        }
    }

</script>
<body>
<h3>학점 별로 학생 수를 입력하면 파이 차트로 비율 그리기</h3>
<hr>
A <input class="score" type="number" value="0">
B <input class="score" type="number" value="0">
C <input class="score" type="number" value="0">
<br>
D <input class="score" type="number" value="0">
F <input class="score" type="number" value="0">

<input onclick="chart()"
       type="button"
       value="차트그리기">
<br><br>
<canvas height="450" id="myCanvas" style="background-color: lightgrey;" width="600"></canvas>
</body>
</html>