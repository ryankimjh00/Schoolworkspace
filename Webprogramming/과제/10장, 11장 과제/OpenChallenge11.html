<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>Document</title>
</head>
<body>
<h3>학점 별로 학생 수를 입력하면 파이 차트로 비율 그리기</h3>
<hr>
A <input class="score" type="number" value="0">
B <input class="score" type="number" value="0">
C <input class="score" type="number" value="0">
<br>
D <input class="score" type="number" value="0">
F <input class="score" type="number" value="0">

<input onclick="chart()"
       type="button"
       value="차트그리기">
<br>

<canvas height="450" id="myCanvas" style="background-color: aliceblue;" width="600">
</canvas>

<script>
    function chart() {
        let colors = ["blue", "green", "yellow", "magenta", "red"];
        let grades = ["A", "B", "C", "D", "F"];
        let p_sum = [];
        let canvas = document.getElementById("myCanvas");
        let context = canvas.getContext("2d");
        context.clearRect(0, 0, canvas.width, canvas.height);

        /*        let a = document.getElementById("a").value;
                let b = document.getElementById("b").value;
                let c = document.getElementById("c").value;
                let d = document.getElementById("d").value;
                let f = document.getElementById("f").value;*/
        let sum = 0;
        for (let i = 0; i < 5; i++) {
            let score = document.getElementsByClassName("score").item(i);
            sum += score[i];
            p_sum[i] = (score[i] / sum) * 100;
        }

        //let sum = Number(a) + Number(b) + Number(c) + Number(d) + Number(f);
        // p_sum.push(eval(a / sum * 100));
        // p_sum.push(eval(b / sum * 100));
        // p_sum.push(eval(c / sum * 100));
        // p_sum.push(eval(d / sum * 100));
        // p_sum.push(eval(f / sum * 100));

        context.fillStyle = "blue";

        for (let i = 0; i < 5; i++) {
            context.fillText(grades[i] + " 학점" + p_sum[i] + "%: " + colors[i], 10, 20 + i * 15);
        }

        let startAngle = 0;
        let endAngle = 0;
        for (let i = 0; i < 5; i++) {
            context.beginPath();
            context.moveTo(canvas.width / 2, canvas.height / 2);
            console.log("start ", colors[i], " ", startAngle);
            endAngle = startAngle + (Math.PI * 2) / 100 * p_sum[i];
            console.log("end ", endAngle);
            context.arc(canvas.width / 2, canvas.height / 2, 200, startAngle, endAngle);
            context.closePath();
            context.fillStyle = colors[i];
            context.fill();

            startAngle = endAngle;
        }
    }
</script>
</body>
</html>